hola que tal youtube videntes bienvenidos una vez más a una nueva entrega de este su curso de ahora con sql desde cero vamos a continuar explorando más y más funciones internas de ahora con sql en el día de hoy pues vamos a ver las funciones de agrupación máx min sum y average estas funciones de ahora con el pse que nos permiten contar registros calcular sumas promedios y obtener valores máximos y mínimos las funciones de grupo de hora col sql son funciones que operan sobre un conjunto de valores o registros y al final pues retornan un solo valor para los ejemplos que vamos a ver el día de hoy pues nos vamos a ir a la descripción del vídeo y vamos a copiar el código que se visualiza allí y después que lo copiemos lo vamos a pegar en nuestro editor de código posteriormente pues lo ejecutamos y confirmamos que se borró la tabla anterior se creó la nueva y se insertaron todas las filas correspondientes limpiamos el editor de código y limpiamos nuestra salida de consola y de inmediato pues hacemos un select a la tabla actualizada y aquí están los registros con los que vamos a trabajar el día de hoy la primera función que vamos a explorar es la función max esta función nos retorna el valor máximo que contiene un campo específico de la tabla digamos que en esta tabla de empleados queremos ver el mayor sueldo insertado en la tabla cuál es el empleado que tiene el mayor sueldo en la empresa pues realizaríamos la siguiente consulta select y colocamos la función max abrimos paréntesis y colocamos el campo sueldo cerramos paréntesis y decimos que haga todo esto desde la tabla empleados ejecutamos la instrucción y noticia que el sueldo máximo es 5.000 seleccionamos el máximo sueldo de la tabla empleados vamos a colocarle un alias recordamos la cláusula as entre doble comillas vamos a decirle que el campo se va a llamar mayor sueldo cerramos doble comillas y ejecutamos y ahora pues el campo ya está más ilegible mayor sueldo 5000 la función que realiza la operación contraria es la función min si quisiéramos saber entonces cuál es el empleado que menos sueldo devenga en la empresa diríamos select min abrimos paréntesis y decimos sueldo cerramos paréntesis colocamos de inmediato el alias us vamos a decirle que el campo se llame menor sueldo cerramos doble comillas hacemos todo esto desde nuestra tabla empleados punto y coma y ejecutamos vemos entonces que el menor sueldo es 2000 el empleado con un menor sueldo gana 2 mil max mayor registro de un campo en una tabla en este caso sueldo min la función min menor registro insertado en una tabla ambas funciones se pueden combinar en una misma consulta digamos que queremos saber entonces cuál es el mayor y menor sueldo pues lo haríamos diciendo max abrimos paréntesis sueldos cerramos paréntesis colocamos nuestro alia mayor sueldo cerramos comillas y entonces pues colocamos una coma y luego colocamos como segunda instrucción la función min abrimos paréntesis sueldo cerramos paréntesis y le decimos que haga todo esto desde la tabla empleados colocamos un punto y coma y aquí está nos faltó el alias del menor sueldo vamos a decirle que nos lo traiga en un campo que diga menor sueldo ejecutamos y aquí está mayor sueldo 5000 menor sueldo 2000 seleccionamos el máximo sueldo en un campo que se llame mayor sueldo y seleccionamos el menor sueldo en un campo que se llame menor sueldo de la tabla empleados función máx y función min ambas juntas en una misma consulta vamos a hacer otra consulta a la tabla bien vamos a decirle al sistema vamos a usar la combinación con la condicional web le vamos a decir al sistema que nos diga cuál de los empleados apellido pérez es quien tiene más hijos ingresados en la tabla para esto le decimos al sistema se le colocamos la función max y colocamos el campo cantidad hijos cerramos paréntesis colocamos un alias a este campo lo vamos a llamar hijos cerramos doble comillas y decimos que haga esto desde la tabla empleados esta ejecución la va a filtrar diciendo que en donde el nombre contenga con el operador like colocamos como ya simple colocamos signo de por ciento y colocamos el apellido pérez cerramos el por ciento cerramos comillas colocamos punto y coma y ejecutamos la instrucción y el sistema nos dice que de los empleados apellido pérez quien más hijos tiene tiene tres dime quién tiene mayor cantidad de hijos en un campo que se llame hijos de la tabla empleados de todos los empleados apellido pérez con esta consulta el sistema lo primero que realiza es la comparación busca en el campo nombre todos los apellidos pérez posteriormente se va entonces al campo cantidad hijos y busca el valor máximo de ese campo y luego lo trae en un campo que se llame hijos y nos trae como resultado 3 lo mismo funcionaría con la función min si en lugar de max le colocamos min el sistema igualmente ejecuta la instrucción y dice que quien menos hijos tiene de todos los empleados tenido pérez tiene un solo bien ahora vamos a ver cómo trabaja la función abras que calcula el promedio de los registros insertados en una tabla vamos a hacer como siempre una consulta para orientarnos vamos a calcular el promedio de salario devengado en toda la empresa vamos a decirle al sistema select colocamos la función al ras se coloca a bg abrimos paréntesis y colocamos el campo sueldo todo desde la tabla empleados cuando ejecutamos esta instrucción dice el sistema que no existe a colocamos mal el nombre de la tabla que es empleados vamos a ejecutar de nuevo ahora si el salario promedio es de 3.400 seleccionamos el promedio de sueldos de la tabla empleados vamos a colocarle el alias entre comillas [Música] diga promedios sueltos y ahí nos cambia el nombre del campo promedio sueldo 3.400 eso es lo que ejecuta la función average el promedio hay que resaltar que el campo el que se le calcula el promedio utilizando la función average debe ser de tipo entero o numérico esto no funciona si se ingresa un campo de tipo variar o de tipo d solamente tiene que ser de tipo entero o numérico vamos a combinar esta función con la cláusula where la condicional web vamos a decirle que nos traiga el promedio de sueldo un campo que se llama promedios sueldos ya todas las secretarias de la empresa como haríamos esto le diríamos select average abrimos paréntesis y decimos sueldo el nombre del campo que queremos ver sería promedio secretarias colocamos doble comillas vamos a decirle que haga todo esto de la tabla empleados y en la siguiente línea vamos a especificar lo que queremos calcular todo esto pero para las secretarias y esto se almacena en el campo sección los cargos de la empresa se almacena en el campo sección entonces decimos donde sección sea igual y entre comillas simples secretaria colocamos punto y coma y ejecutamos la instrucción y nos dicen que el salario promedio de las secretarias de la empresa es 2100 seleccionan el promedio de sueldos en un campo que se llame promedios secretarias de la tabla empleados donde la sección sea igual a secretaria y nos dice que ese promedio es 2100 continuamos viendo las funciones de agrupación de oracle vamos a ver ahora la función sum que nos realiza la sumatoria de todos los registros de un campo en específico si quisiéramos ver la sumatoria de todos los salarios en la empresa le decimos al sistema select sum y abrimos paréntesis colocamos el campo sueldo cerramos paréntesis from empleados ejecutamos la instrucción y nos dice que la sumatoria de todos los sueldos de la empresa es 27 mil 200 tocamos nuestro alias entre comillas el campo se va llaman sumatoria salarios vamos a ejecutar de nuevo ahí esta sumatoria salarios 27.200 utilizando la cláusula where vamos a decirle que nos sume todos los salarios del departamento de sistemas pues en este caso utilizando esta misma consulta seleccionamos la sumatoria de los sueldos en un campo que se llame sumatoria salarios de la tabla empleados y decimos donde sección que son los puestos sea igual a entre comillas simples sistemas cerramos comillas simple punto y coma y ejecutamos la instrucción y nos dice que el departamento de sistemas en total devenga 8.000 la función max y la función min también operan sobre tipos de datos fecha es decir tipo de datos beit digamos que queremos saber cuál es el empleado más nuevo en la empresa o cuál es el empleado más viejo o ambos utilizando esta función le podemos decir al sistema max abrimos paréntesis ingresamos fecha ingreso cerramos paréntesis colocamos una coma y decimos min y entre paréntesis ponemos fecha ingreso cerramos paréntesis y decimos que haga todo esto desde la tabla empleados ejecutamos la instrucción y aquí nos trae fecha máxima 25 septiembre 2001 fecha más reciente 10 de octubre del año 80 vamos a colocarle alias para a modo de reporte entender mejor el resultado de la consulta vamos a decir as y entre comillas dobles decimos empleado más nuevo cerramos comillas dobles y en min fecha de ingreso vamos a decirle as entre doble comillas empleado más viejo cerramos doble comillas traemos para acá el from empleados ejecutamos la instrucción y aquí pues como les dije a modo de reporte el sistema nos trae más legible la consulta dice que el empleado más nuevo está en la empresa desde el 25 de septiembre 2001 y el más viejo está la empresa desde el 10 de octubre del año 80 selecciona me la más vieja fecha de ingreso como selecciona me la máxima fecha de ingreso en un campo que se llama empleado más nuevo y la menor fecha de ingreso en un campo que se llame empleado más viejo de la tabla empleados y nos trae este resultado y bueno eso es todo por ahora referente a las funciones de agrupación de ahora con sql recuerden ir ejecutando más prácticas cambiando los valores más adelante seguiremos viendo cómo combinar estas funciones con otras anteriores que hemos ido ya viendo así que gracias por su atención y hasta pronto