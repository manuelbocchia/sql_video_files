hola que tal youtube videntes bienvenidos una vez más a este su canal informático fica este curso de ahora con sql desde cero en el día de hoy vamos a entrar a trabajar con lo que son las claves foráneas o los for en key en ahora con sql una clave foránea es un campo que no está configurado como clave primaria en una tabla pero que se utiliza para enlazar sus valores con otra tabla en la cual existe otro campo con esa misma configuración pero establecido como clave primaria aquí vemos un esquema de una base de datos relacional más adelante cuando estemos entrando en lo que es data model de oracle vamos a aprender cómo diseñar esta estructura de base de datos en lo que se llama diseño lógico en oracle como vemos acá todas estas tablas están interrelacionadas con sus llaves primarias y sus llaves foráneas primary key y foreign que existen reglas para la configuración de las claves foráneas una de ellas es tanto las claves foráneas como las claves primarias deben ser del mismo tipo para poder enlazarse si se modifica una pues debemos modificar la otra para que los valores se correspondan más adelante estaremos viendo cómo hacer esto otra de las reglas es que cuando alteramos una tabla debemos tener cuidado con las claves foráneas ya que si modificamos el tipo la longitud o los atributos de una clave foránea pues ésta puede quedar inhabilitada para hacer los enlaces ya que los campos estarían diferentes y pues en resumen diríamos que una clave foránea pues no es más que un campo o varios que se utilizan para enlazar datos de dos tablas para establecer un join con otra tabla en la cual ese mismo tipo de campo está configurado como clave primaria muy bien y de inmediato nos vamos a nuestro sql de bellver para empezar a trabajar con las llaves foráneas lo primero que vamos a hacer es eliminar dos tablas vamos a digitar la instrucción drop table clientes esto va a eliminar la tabla de clientes que teníamos anteriormente creadas el sistema nos confirma que se eliminó y igualmente vamos a borrar una tabla que habíamos creado anteriormente llamada provincias si al ejecutar estos drop table el sistema les dice que no fueron encontradas las tablas no se preocupen simplemente no las tenían creadas en el sistema luego de borradas estas tablas vamos entonces a proceder de nuevo con la creación de las mismas estableciendo las configuraciones que necesitamos para ver los ejemplos de hoy vamos a colocar create table provincias abrimos paréntesis debajo entonces creamos un campo que se llame código va a recibir datos de tipo nombre con dos dígitos de tamaño éste lo vamos a establecer como llave primaria diciendo primeriti y obligatorio colocándolo como note colocamos una coma debajo vamos a crear un campo que se va a llamar nombre hacer de tipo marchar 2 iba a recibir 20 caracteres como tamaño luego debajo colocamos paréntesis y punto y coma con esto terminamos de crear nuestra primera tabla vamos a sombrear todo ejecutamos sistema nos confirma que se creó correctamente continuamos debajo vamos a crear una segunda tabla y se va a llamar clientes abrimos paréntesis y debajo creamos un campo va a llamar código tipos de datos nombre tamaño 5 colocamos una coma y luego creamos otro campo que se va a llamar nombre de tipo bar char 2 y tamaño 30 colocamos una coma otro campo domicilio de tipo marchar 2 abrimos paréntesis tamaño 30 una coma luego debajo ciudad marchar 2 de tamaño 20 una coma y por último el campo código provincia y va a ser tipo nombre de tamaño 2 al final cerramos paréntesis colocamos punto y coma sombre amos y ejecutamos el sistema nos dicen que se creó correctamente la tabla clientes vamos a proceder ahora a crear una llave foránea en nuestra tabla de clientes para esto vamos a alterar nuestra tabla de clientes diciendo alter table clientes debajo colocamos con strange vamos a colocar entonces la nomenclatura efe acá para indicar que es un fortín que colocamos un guión código provincias luego debajo especificamos que la restricción que vamos a crear es fortín y llave foránea abrimos paréntesis y vamos a especificar a qué campos se le va a aplicar esta restricción va a ser el campo código provincia cerramos paréntesis y luego lo que hacemos es referenciar nuestra llave foránea a nuestra tabla de provincias que contiene la llave primaria en el campo código cerramos paréntesis colocamos punto y coma ejecutamos toda esta instrucción el sistema nos dice que se alteró correctamente la tabla que es lo que hicimos aquí alteramos nuestra tabla clientes agregamos una restricción que se llama fk código provincias luego levi le decimos al sistema que esta restricción será un fortín key llave foránea que será agregada al campo código provincia de nuestra tabla de clientes entonces esta llave la vamos a enlazar referenciando la a la tabla de provincias en el campo código de esta tabla que es el que configuramos anteriormente como primer y que llame primaria ya con esto realizamos el enlace lógico de nuestra tabla clientes con su campo código provincia a nuestra tabla de provincias con su campo código y con esto terminamos nuestra llave foránea si nos vamos a nuestro editor de objetos donde dice tablas hacemos un refresh confirmamos aquí en nuestra tabla clientes y hacemos un clic y nos vamos a la pestaña de constraints fíjense entonces ya como el sistema nos confirma que se creó un foro que en nuestra tabla provincias donde dice tipo de construyen for in que nos coloca el esquema bajo el cual se creó que es ahora con el que estamos trabajando la tabla a la que se referencia que es provincias el estatus que dice que está habilitada la validación y dice que está correctamente validada posteriormente si hacemos un clic acá en la pestaña que dice model aquí vemos como el sistema ya nos preparó el diseño de enlace de nuestras dos tablas lo vemos acá esquema curso ahora con tabla clientes nos dice que está referenciada hacia la tabla de provincias de su campo código como lo vemos acá está ya visita que está aquí está ya visita dorada tiene el fk código provincias que es el nombre que le dimos a nuestro fortín que aquí especifica el campo y como lo vemos la flechita acá nos indica que en referencia a la tabla provincias de nuestro campo código que es primary que aquí lo vemos con la llavecita plateada dice provincias pk ese es el nombre de la llave primaria de la tabla provincias en su campo código y así quedan enlazadas estas dos tablas con las reglas de primary key y for in que nos vamos a ir a la descripción del vídeo y ahí vamos a copiar unos intereses que tenemos preparados para llenar estas dos tablas y los vamos a pegar en nuestro editor de esta manera posteriormente ejecutamos todas estas instrucciones y fíjense aquí como insertado correctamente varias filas pero acá vemos un error vamos a analizar este error que está acá dice integridad de constraints curso ahora que la curso ahora con efe cada código provincias violado dice parent kit notifam y aquí nos dice cuál es el registro insertando el registro de clientes dice aquí los valores que fallaron en el ince si nos vamos al link ser vemos que los valores que fallaron son de este registro que está acá en la línea 9 y por qué falló este registro este registro falló porque si se fijan los campos que enlazan la tabla provincias y clientes son el campo código y el campo código provincias en el campo código provincias estos valores son 1 2 3 4 y la regla dice que deben ser exactamente iguales los registros entre ambas tablas ya que están enlazadas por un constraints una regla de enlace entre tablas de primary key y fort en que por lo tanto aquí el valor 1 2 y 3 que es el campo código provincia de nuestra tabla clientes tiene un valor 6 en este registro como no existe un valor 6 en el campo código de la tabla provincias este registro no encuentra validación con ningún registro esta tabla ya que no hay un valor 6 sólo hay 1234 al haber un 6 acá entonces pues genera error que dice que la integridad del for y que dice que fue violada porque no encuentra relación con la llave primaria es por eso que nos permite insertar este registro en esta tabla con el valor 6 vamos a hacer un selecto a nuestra tabla de provincias digamos que queremos borrar entonces un registro de esta tabla vamos a decir el it from provincias donde el código sea igual a 1 vamos a intentar borrar este primer el registro cuando intentamos borrarlo vemos de nuevo que el sistema nos dice integrity constraints dio later es decir no permite borrar este registro porque no se especifica si el record fan es decir hay un registro hijo que es como ahora con lo identifica los registros de llave foránea que fue encontrado por lo tanto recuerden que la regla dice que se debe borrar siempre primero desde la tabla que contiene la llave foránea la regla de la llave primaria de la tabla provincias impide que se borre este registro ya que está enlazado como un registro de la tabla de clientes para borrar una llave foránea en la cual sql simplemente colocamos la instrucción altera table en este caso clientes que es la tabla que contiene la restricción y le decimos drop constraints y colocamos el nombre de nuestra llave primaria efe acá código provincias seleccionamos esta instrucción y la ejecutamos el sistema nos confirma que fue alterada la tabla de clientes por lo tanto fue eliminada la restricción por inc y de la tabla de clientes esto indica que si queremos de nuevo intentar borrar este registro cuando ejecutemos podemos eliminarlos sin ningún problema ya que no existe el fortín key que retenga la ejecución y bien eso es todo por ahora referente a llaves foráneas en ahora con sql más adelante continuaremos viendo más ejemplos de manejos de esta restricción por ahora gracias por su atención y hasta pronto