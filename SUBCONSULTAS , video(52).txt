hola que tal youtube videntes bienvenidos una vez más a este su curso de ahora con sql es de cero en el día de hoy vamos a empezar a trabajar con las sub consultas en oracle y que es una sub consulta bueno pues ahora su consulta es una sentencia select update o delete que está anidada dentro de otras sentencias select global o también podría estar anidada dentro de otras sub consulta las sub consultas se emplean cuando una consulta es muy compleja lo que amerita entonces que haya que dividir en varios requerimientos dicha consulta y se obtiene el resultado luego en una única instrucción de igual modo se utiliza una sub consulta cuando la consulta principal depende de los resultados de una consulta secundaria para los ejemplos del día de hoy como siempre les voy a dejar en la descripción del vídeo la siguiente instrucción con el borrado y creación de una tabla de alumnos con la que vamos a estar trabajando vamos a pegar estas instrucciones en editor y posteriormente vamos a proceder a ejecutarla y confirmamos que se borró la tabla de alumnos la teníamos creada anteriormente los que no la tenían creada no hay problemas porque posteriormente la creamos de nuevo e insertamos todos los registros pertinentes sin errores limpiamos nuestra salida de consola y limpiamos nuestro editor de inmediato vamos a crear una primera sub consulta bueno antes vamos a hacer un selecto a nuestra tabla de alumnos y aquí están los registros con los que vamos a trabajar vamos a preparar una consulta que nos diga los registros de los alumnos que tengan la nota más alta como ya sabemos existe una forma de determinar cuál sería el alumno con la nota más alta si dijéramos select max no está from alumnos hacemos esta consulta vemos que la nota más alta es 110 sin embargo pues esta es una información incompleta y poco detallada necesitaríamos ver cuál es el alumno con la nota más alta entre otros campos informativos de la tabla para esto entonces es que no sería útil una sub consulta en este caso pues ya tenemos una parte de el requerimiento que es saber la nota más alta de los alumnos que es el número 10 posteriormente esto tenemos que unirlo a una consulta en donde nos diga cuál es el alumno con la nota más alta lo que haría entonces qué dividiéramos la consulta en dos una consulta global y una sub consulta entonces diríamos select asterisco from alumnos y con esto ya estamos diciendo que vamos a traer todos los datos de el alumno sin embargo tenemos que hacer un filtro y ese filtro es saber cuál es la nota más alta por lo tanto entonces la función para filtrar los registros que es la función where decimos no está igual y aquí ya de inmediato entonces es abriendo paréntesis donde colocamos nuestra sub consulta cerramos paréntesis al final y ejecutamos cuando ejecutamos fíjense ahora como el sistema nos trae el documento el nombre de el alumno y la nota aquí es la más alta analizamos entonces la sub consulta estamos buscando el alumno con la nota más alta de la tabla de alumnos por lo tanto lo que hacemos es identificar el segundo requerimiento que sería la nota más alta en este caso colocamos seleccionamos la máxima nota de la tabla alumnos que eso es lo que llamaremos el requerimiento que va a ser filtrado y como ya vimos haciendo solamente esta consulta vemos que solamente nos trae la nota pero no los demás datos del alumno por lo tanto haciendo una consulta global a la tabla diciendo select asterisco from alumnos en donde la nota sea y según la consulta máxima nota de la tabla ejecutamos todo esto entonces ya el sistema nos trae los demás datos documento y nombre de el alumno como lo ven esta es la sub consulta que está dentro de una consulta global la cual nos ayuda a adquirir el requerimiento que se necesita filtrar dentro de una consulta más amplia vamos a ver ahora un segundo ejemplo de sub consultas en ahora con sql y veamos el siguiente requerimiento nos dice consulte la o las notas que sean menores al promedio de notas en la clase aquí tenemos una consulta a la cual hay que dividir en una consulta global y una sub consulta si se fijan nos dice consulte la o las notas que sean menores al promedio en esta parte ya entendemos que tenemos primero que identificar cuáles son las notas menores al promedio y para esto claro está primero hay que buscar el promedio y luego identificar cuáles notas son menores a este promedio obtenido cómo se obtiene el promedio en sql pues se obtiene con la función a vejez si recuerdan nuestra lección calculando el promedio de valores decimos select abc entre paréntesis nota from alumnos punto y coma seleccionamos todo esto ejecutamos y aquí tenemos un dato interesante el promedio de notas nos lo está generando con muchos decimales en este caso pues utilizamos la función que ya conocemos round vamos a redondear esta nota utilizando round entre paréntesis a vejez nota y cerramos paréntesis con esto lo que estamos haciendo es indicándole al sistema que haga un redondeo de el promedio de notas obtenido de la tabla alumnos seleccionamos ejecutamos aquí está este es el promedio de notas de la clase vamos a colocarle un alias en este campo para que sea más legible digamos promedio flexiona mi promedio de notas en un campo que se llama promedio de la tabla alumnos ponte coma seleccionamos ejecutamos y aquí están promedios de notas de la clase es 8 aquí ya tenemos entonces el promedio calculado que es parte de el requerimiento por lo tanto el siguiente que hay que identificar es cuáles notas son menores a este promedio entonces preparamos como solamente tenemos el promedio no tenemos el nombre de los alumnos que ostentan notas menores a este promedio tal como lo pide el requerimiento vamos entonces a obtener los otros datos diciendo select asterisco from alumnos y aquí entonces aplicamos el filtro las notas que sean menores al promedio entonces aquí decimos were not a colocamos signo de menor entonces menor aquí al promedio y cuál es el promedio esta consulta que hicimos aquí por lo tanto abrimos paréntesis y la colocamos entre dichos paréntesis cuando hacemos el cel fíjense ahora como el sistema nos trae todas las notas que son menores al promedio si recuerdan el promedio era 8 aquí tenemos 7 6 6 y estos son todos los alumnos que tienen notas menores al promedio tal como nos lo pide el requerimiento selecciona todos los datos de la tabla alumnos en donde la nota sea menor y entre paréntesis sacamos el promedio de notas en un campo que se llama promedio de la tabla alumnos las sub consultas también nos sirven para actualizar registros en una tabla digamos que en este caso fuéramos a actualizar todas las notas que son menores al promedio en lugar de colocarse select from alumnos podríamos simplemente colocar sub de trump alumnos en este caso como ya tenemos el update tenemos que colocar el valor que vamos a actualizar y diríamos no está igual a 5 tenemos una advertencia acá a bueno no debemos colocar from es un error hay se debe colocar solamente a day alumnos set no está igual 5 actualizar la tabla alumnos colocan una nota igual a 5 donde la nota sea menor al promedio obtenido de la tabla de alumnos ejecutamos toda esta instrucción y el sistema nos dice que se actualizó correctamente si hacemos un selecto a la tabla de alumnos podremos confirmar entonces que se actualizaron los registros y aquí están todos los registros menores al promedio están actualizados a 5 tal como lo especificamos aquí en el update y claro está del mismo modo la función delete se puede utilizar también en sub consultas en este caso en lugar de actualizar las notas menores al promedio las vamos a eliminar solamente tendríamos que colocar la instrucción estilo from alumnos y aquí ya tenemos los demás creado que es donde la nota sea menor al promedio seleccionamos el borrado de los registros el sistema dice que se borraron tres filas hacemos el select y vemos cómo desaparecieron todas las notas menores a 8 y bien eso es todo por ahora referente a las sub consultas en ahora con sql más adelante seguiremos viendo más funcionalidades de sub consultas por ahora gracias por su atención y hasta pronto